<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ordermade.store.mapper.InviteRequestMapper">
	<resultMap type="InviteRequest" id="inviteRequestMap">
		<result property="id" column="id" />
		<result property="message" column="message" />
		<result property="form" column="form" />
		<result property="requestTime" column="request_time" jdbcType="NUMERIC" />
		<association property="member" column="member_id"
			select="store.mapper.MemberMapper.selectMemberById" javaType="Member"
			jdbcType="VARCHAR" />
		<association property="request" column="request_id"
			select="store.mapper.RequestMapper.selectRequestById" javaType="Request"
			jdbcType="VARCHAR" />
	</resultMap>
	
	<sql id="selectInviteRequest">
		SELECT id, message, member_id, request_time, request_id, form
		FROM invite_request
	</sql>
	
	<insert id="insertInviteRequest" parameterType="inviteRequest">
		INSERT INTO invite_reqeust(id, message, member_id, request_time, request_id, form)
		VALUES (#{id},#{message},#{member.id},TO_DATE(sysdate,'yyyy/mm/dd hh24:mi:ss'),#{request.id},#{form})
	</insert>
	
	<delete id="deleteInviteRequestById" parameterType="id">
		DELETE FROM invite_request
		WHERE id = #{id}
	</delete>
	
	<delete id="deleteInviteRequestsByRequestId" parameterType="requestId" >
		DELETE FROM invite_request
		WHERE reuquest_id = #{id}
	</delete>
	
	<select id="selectInviteRequestsByMakerId" parameterType="HashMap" resultMap="inviteRequestMap">
		SELECT id, message, member_id, request_time, request_id, form
		FROM (SELECT rownum, id, message, member_id, request_time, request_id, form FROM invite_request WHERE makerId = #{member.Id})
		WHERE rownum BETWEEN #{begin} AND #{end}
	</select>
</mapper>
  