<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ordermade.store.mapper.TagMapper">
	<resultMap type="ordermade.domain.Tag" id="TagMap">
		<id column="id" property="id" />
		<result column="keyword" property="keyword" />
		<result column="score" property="score" />
		<association column="portfolioid" property="portfolio"
			javaType="Portfolio" jdbcType="VARCHAR"
			select="ordermade.store.mapper.PortfolioMapper.selectPortfolioById" />
	</resultMap>

	<insert id="insertTag" parameterType="Tag">
		<selectKey keyProperty="id" resultType="string" order="BEFORE">
			select tag_seq.nextval from dual
		</selectKey>
		INSERT INTO tag(id,keyword,score,portfolio_id)
		VALUES
		(#{id},#{keyword},#{score},#{portfolio.id})

	</insert>
	<select id="selectTagsByPortfolioId" parameterType="string" resultMap="TagMap">
		SELECT id,keyword,score,portfolio_id
		FROM tag
		WHERE portfolio_id = #{portfolioId}
	</select>
	<delete id="deleteTagById" parameterType="string">
		DELETE FROM tag
		WHERE id
		= #{id}
	</delete>

</mapper>
